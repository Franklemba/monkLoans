<div class="container">        
    <!-- About Section -->
    <div class="about-main">
        <div class="row">
         <div class="col-lg-6">
           <h2>Borrow</h2>
           <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
           <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
           <button type="button" class="btn btn-primary btn-icon" id="dashboardButton">
            <a href="/credit/dashboard"><i class="fas fa-tachometer-alt"></i> DASHBOARD</a> 
          </button>
          
        </div>
         <div class="col-lg-6 applyLoanContainer container">
           <div class="modal-dialog modal-dialog-centered">
             <div class="modal-content">
               <div class="modal-header">
                 <h5 class="modal-title" id="loanModalLabel">Get a Loan Upto K500</h5>
                 <!-- <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button> -->
               </div>
               <div class="modal-body">
                 <form action="/credit/page" method="post">
                  <!-- <hr> -->
                   <div class="mb-3">
                     <label for="loanAmount" class="form-label">How much would you like?</label>
                     <input type="number" class="form-control" id="loanAmount" name="loanAmount" value="200" min="100" max="500">
                   </div>
                   <div class="mb-3">
                     <label for="loanTerm" class="form-label">Tenure (weeks):</label>
                     <!-- <input type="number" class="form-control" id="loanTerm" name="loanTerm" value="1" min="1" max="4"> -->
                     <select name="loanTerm" id="loanTerm">
                        <option value="1">1 week</option>
                        <option value="2">2 weeks</option>
                        <option value="3">3 weeks</option>
                        <option value="4">4 weeks</option>
                     </select>
                   </div>
                   
                   <hr>
 
                   <div class="modalBottom">
                       
                   <div class="mb-3">
                     <label for="serviceFee" class="form-label">Service Fee</label>
                     <input type="text" class="form-control" id="serviceFee" name="serviceFee" value="K5.00" disabled>
                   </div>
                   <div class="mb-3">
                     <label for="amountReceived" class="form-label">Amount You Receive</label>
                     <input type="text" class="form-control" id="amountReceived" name="amountReceived" value="K495.00" disabled>
                   </div>
                   <div class="mb-3">
                     <label for="repaymentAmount" class="form-label">Repayment</label>
                     <input type="text" class="form-control" id="repaymentAmount" name="repaymentAmount" value="K580.00" disabled>
                   </div>
                   <div class="mb-3">
                     <label for="nextPaymentDate" class="form-label">Next Payment Date</label>
                     <input type="date" class="form-control" id="nextPaymentDate" name="nextPaymentDate" value="2023-10-31" disabled>
                   </div>
                   <hr>
                   <button type="submit" class="btn btn-primary">APPLY</button>

                   
                  </div>
                 </form>
               </div>
               
             </div>
           </div>
         </div>
        </div>
        <!-- /.row -->


        <br>
        <br>
        <div class="row">
            <div class="col-lg-6">
              <h5>Our Regulations</h5>
              <ul>
                 <li>Phasellus quis erat et enim laoreet posuere ac porttitor ipsum.</li>
                 <li>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</li>                     
                 <li>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</li>
                 <li>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</li>
                 <li>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</li>
              </ul>
           </div>
           <div class="col-lg-6">
            <h5>Requirements</h5>
            <ul>
               <li>Phasellus quis erat et enim laoreet posuere ac porttitor ipsum.</li>
               <li>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</li>                     
               <li>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</li>
               <li>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</li>
               <li>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</li>
            </ul>
         </div>
             
           </div>
    </div>
 </div>	




 <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
  $(document).ready(function () {
    // Define interest rates for different loan terms
    const interestRates = {
      1: 0.05, // 5% for a 1-week term
      2: 0.1, // 6% for a 2-week term
      3: 0.15, // 7% for a 3-week term
      4: 0.20, // 8% for a 4-week term
    };

    // Function to calculate the repayment amount
    function calculateRepayment() {
      const loanAmount = parseFloat($("#loanAmount").val());
      const loanTerm = parseInt($("#loanTerm").val());

      var delayTimer;

    $("#loanAmount").on("input", function() {
      clearTimeout(delayTimer); // Clear the previous timer (if any)
      var inputValue = parseInt($(this).val(), 10);

      // Define the delay (in milliseconds) before applying the change
      var delay = 500; // Adjust this value as needed

      delayTimer = setTimeout(function() {
        if (inputValue < 100) {
          $("#loanAmount").val(100);
        } else if (inputValue > 500) {
          $("#loanAmount").val(500);
        }
      }, delay);
    });
    
      if (!isNaN(loanAmount) && !isNaN(loanTerm)) {
        // Calculate interest based on selected loan term
        const interestRate = interestRates[loanTerm];
        
        // Calculate service fee (assuming a fixed fee of K5.00)
        const serviceFee = 5;
        
        // Calculate total repayment amount
        const interestAmount = loanAmount * interestRate;
        const totalRepayment = loanAmount + interestAmount + serviceFee;
        
        // Display calculated values
        $("#serviceFee").val(`K${serviceFee.toFixed(2)}`);
        $("#amountReceived").val(`K${(loanAmount - serviceFee).toFixed(2)}`);
        $("#repaymentAmount").val(`K${totalRepayment.toFixed(2)}`);
        
        // Calculate and display next payment date (assuming 7 days per week)
        const today = new Date();
        const nextPaymentDate = new Date(today.getTime() + loanTerm * 7 * 24 * 60 * 60 * 1000);
        const formattedDate = nextPaymentDate.toISOString().substr(0, 10);
        $("#nextPaymentDate").val(formattedDate);
      }
    }

    // Add an event listener to the loanAmount and loanTerm inputs
    $("#loanAmount").on("input", calculateRepayment);
    $("#loanTerm").on("input", calculateRepayment);
    $("#loanType").on("change", calculateRepayment);

    // Calculate repayment on page load
    calculateRepayment();
  });
</script>